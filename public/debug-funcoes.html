<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>ğŸ” Debug FunÃ§Ãµes</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-8">
    <h1 class="text-2xl mb-4">ğŸ” Debug - VerificaÃ§Ã£o de FunÃ§Ãµes</h1>
    
    <div class="space-y-4">
        <button onclick="verificarFuncoes()" class="bg-blue-500 text-white px-4 py-2 rounded">
            Verificar FunÃ§Ãµes
        </button>
        
        <button onclick="testarModal()" class="bg-green-500 text-white px-4 py-2 rounded">
            Testar Modal
        </button>
        
        <button onclick="testarAPI()" class="bg-purple-500 text-white px-4 py-2 rounded">
            Testar API UsuÃ¡rios
        </button>
    </div>
    
    <div id="resultado" class="mt-6 p-4 bg-gray-100 rounded"></div>

    <!-- Modal simples para teste -->
    <div id="modalTeste" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
            <h3 class="text-lg font-bold mb-4">ğŸ§ª Modal de Teste</h3>
            <p>Se vocÃª vÃª isso, o modal funciona!</p>
            <button onclick="fecharTeste()" class="mt-4 bg-red-500 text-white px-4 py-2 rounded">
                Fechar
            </button>
        </div>
    </div>

    <script src="js/usuarios.js"></script>
    <script>
        function log(msg) {
            const resultado = document.getElementById('resultado');
            resultado.innerHTML += `<div>${msg}</div>`;
            console.log(msg);
        }

        function verificarFuncoes() {
            log('ğŸ” Verificando funÃ§Ãµes...');
            
            const funcoes = [
                'abrirModalNovoUsuario',
                'fecharModalNovoUsuario', 
                'criarUsuario',
                'carregarUsuarios'
            ];
            
            funcoes.forEach(nome => {
                if (typeof window[nome] === 'function') {
                    log(`âœ… ${nome}: EXISTE`);
                } else {
                    log(`âŒ ${nome}: NÃƒO EXISTE`);
                }
            });
        }

        function testarModal() {
            log('ğŸ§ª Testando modal...');
            try {
                if (typeof window.abrirModalNovoUsuario === 'function') {
                    window.abrirModalNovoUsuario();
                    log('âœ… FunÃ§Ã£o chamada com sucesso!');
                } else {
                    log('âŒ FunÃ§Ã£o nÃ£o existe!');
                    // Teste com modal simples
                    document.getElementById('modalTeste').classList.remove('hidden');
                    log('ğŸ”§ Modal simples aberto para teste');
                }
            } catch (error) {
                log(`âŒ Erro: ${error.message}`);
            }
        }

        function fecharTeste() {
            document.getElementById('modalTeste').classList.add('hidden');
            log('âœ… Modal de teste fechado');
        }

        async function testarAPI() {
            log('ğŸ“¡ Testando API de usuÃ¡rios...');
            try {
                const response = await fetch('/api/users', {
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('token')}`
                    }
                });
                
                log(`ğŸ“Š Status: ${response.status}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log(`âœ… UsuÃ¡rios encontrados: ${data.users ? data.users.length : 0}`);
                    if (data.users) {
                        data.users.forEach(user => {
                            log(`ğŸ‘¤ ${user.name} (${user.email}) - ${user.role}`);
                        });
                    }
                } else {
                    const error = await response.json();
                    log(`âŒ Erro API: ${error.message}`);
                }
            } catch (error) {
                log(`âŒ Erro de rede: ${error.message}`);
            }
        }

        // Auto-verificar quando carregar
        window.addEventListener('load', function() {
            setTimeout(verificarFuncoes, 1000);
        });
    </script>
</body>
</html>
