<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Teste Modal Usu√°rios</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-8">
    <h1 class="text-2xl mb-4">üß™ Teste Modal Usu√°rios</h1>
    
    <div class="space-x-4 mb-4">
        <button onclick="testeSimples()" class="bg-blue-500 text-white px-4 py-2 rounded">
            1. Teste Simples
        </button>
        
        <button onclick="testeModal()" class="bg-green-500 text-white px-4 py-2 rounded">
            2. Teste Modal
        </button>
        
        <button onclick="testeFormulario()" class="bg-purple-500 text-white px-4 py-2 rounded">
            3. Teste Formul√°rio
        </button>
        
        <button onclick="abrirModalNovoUsuario()" class="bg-teal-600 text-white px-4 py-2 rounded">
            4. Fun√ß√£o Original
        </button>
    </div>
    
    <div id="resultados" class="bg-gray-100 p-4 rounded">
        <h3>Resultados dos Testes:</h3>
        <div id="log"></div>
    </div>

    <!-- Modal de Teste -->
    <div id="modalTeste" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
            <h3 class="text-lg font-bold mb-4">Modal de Teste</h3>
            <form id="formTeste" onsubmit="processarForm(event)">
                <div class="mb-4">
                    <label class="block mb-2">Nome:</label>
                    <input type="text" name="name" required class="w-full border rounded px-3 py-2">
                </div>
                <div class="mb-4">
                    <label class="block mb-2">Email:</label>
                    <input type="email" name="email" required class="w-full border rounded px-3 py-2">
                </div>
                <div class="flex space-x-2">
                    <button type="button" onclick="fecharModal()" class="bg-gray-500 text-white px-4 py-2 rounded">
                        Cancelar
                    </button>
                    <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">
                        Enviar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Original (copiado de usuarios.html) -->
    <div id="modalNovoUsuario" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4">
            <div class="p-6 border-b">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-gray-800">Criar Novo Usu√°rio</h3>
                    <button onclick="fecharModalNovoUsuario()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <form id="formNovoUsuario" class="p-6 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nome Completo</label>
                    <input type="text" name="name" id="novoNome" required 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" name="email" id="novoEmail" required 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                    <input type="password" name="password" id="novaSenha" required minlength="6"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Empresa</label>
                    <input type="text" name="company" id="novaEmpresa" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tipo</label>
                    <select name="role" id="novoRole" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                        <option value="user">Usu√°rio Normal</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
                <div class="flex space-x-3 pt-4">
                    <button type="button" onclick="fecharModalNovoUsuario()" 
                            class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg">
                        Cancelar
                    </button>
                    <button type="submit" 
                            class="flex-1 px-4 py-2 bg-teal-600 text-white rounded-lg">
                        Criar Usu√°rio
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            logDiv.innerHTML += `<div>[${time}] ${message}</div>`;
            console.log(message);
        }

        function testeSimples() {
            log('‚úÖ Teste simples funcionou!');
            alert('Teste simples OK!');
        }

        function testeModal() {
            log('üîÑ Abrindo modal de teste...');
            const modal = document.getElementById('modalTeste');
            if (modal) {
                modal.classList.remove('hidden');
                log('‚úÖ Modal de teste aberto!');
            } else {
                log('‚ùå Modal de teste n√£o encontrado!');
            }
        }

        function fecharModal() {
            log('üîÑ Fechando modal de teste...');
            document.getElementById('modalTeste').classList.add('hidden');
        }

        function testeFormulario() {
            log('üìù Testando formul√°rio...');
            const form = document.getElementById('formTeste');
            if (form) {
                log('‚úÖ Formul√°rio encontrado!');
                testeModal(); // Abrir modal para testar
            } else {
                log('‚ùå Formul√°rio n√£o encontrado!');
            }
        }

        function processarForm(e) {
            e.preventDefault();
            log('üìã Processando formul√°rio de teste...');
            const formData = new FormData(e.target);
            const data = {
                name: formData.get('name'),
                email: formData.get('email')
            };
            log('üìä Dados: ' + JSON.stringify(data));
            alert('Formul√°rio processado: ' + JSON.stringify(data));
            fecharModal();
        }

        // Fun√ß√µes do sistema original
        function abrirModalNovoUsuario() {
            log('üîÑ Tentando abrir modal original...');
            
            const modal = document.getElementById('modalNovoUsuario');
            const form = document.getElementById('formNovoUsuario');
            
            if (!modal) {
                log('‚ùå Modal original n√£o encontrado!');
                alert('Erro: Modal n√£o encontrado');
                return;
            }
            
            if (!form) {
                log('‚ùå Form original n√£o encontrado!');
                alert('Erro: Formul√°rio n√£o encontrado');
                return;
            }
            
            log('‚úÖ Modal e form originais encontrados, abrindo...');
            modal.classList.remove('hidden');
            form.reset();
            log('‚úÖ Modal original aberto!');
        }

        function fecharModalNovoUsuario() {
            log('üîÑ Fechando modal original...');
            const modal = document.getElementById('modalNovoUsuario');
            if (modal) {
                modal.classList.add('hidden');
                log('‚úÖ Modal original fechado!');
            }
        }

        // Event listener para o form original
        document.addEventListener('DOMContentLoaded', function() {
            log('üìã DOM carregado!');
            
            const form = document.getElementById('formNovoUsuario');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    log('üìù Submit do form original interceptado!');
                    
                    const formData = new FormData(e.target);
                    const userData = {
                        name: formData.get('name'),
                        email: formData.get('email'),
                        password: formData.get('password'),
                        company: formData.get('company'),
                        role: formData.get('role')
                    };
                    
                    log('üìä Dados do usu√°rio: ' + JSON.stringify(userData));
                    
                    // Simular cria√ß√£o de usu√°rio
                    alert('Usu√°rio seria criado: ' + JSON.stringify(userData));
                    
                    fecharModalNovoUsuario();
                });
                
                log('‚úÖ Event listener adicionado ao form!');
            } else {
                log('‚ùå Form n√£o encontrado para adicionar event listener!');
            }
        });
    </script>
</body>
</html>
